<!DOCTYPE html>
<html>
<head>
    <title>Task C</title>
    <link rel="stylesheet" type="text/css" href="tC.css">
</head>
<body>
<div style="width: 1024px; height: 768px;border:1px solid black;background-color: darkgray ">
<!--max:932/676-->
        <a id="circle" class="circle" style="position:absolute;top: 50px ;left:932px;width: 50px;
    height: 50px;" ></a>
</div>
</body>
<script type="text/javascript">
    var circle = document.getElementById("circle");
    var lastY =parseFloat(circle.style.top);
    var lastX=parseFloat(circle.style.left);
    circle.addEventListener("click", clickFunk);
    var v1=0;
    var v2=0;
    var v3=0;
    var v4=0;
    var v5=1;
    var count= 0;
    var dXArray= new Array;
    var dYArray = new Array;
    var wArray = new Array;
    wArray.push(50);
    var oldSize;
    var tArray = new Array;
    var lastTimeClicked;


    function clickFunk() {
        if (count<4){
            if (count===0){
                lastTimeClicked = new Date().getTime();
            }else {
                var newTime = new Date().getTime();
                var deltaTime = newTime - lastTimeClicked;
                tArray.push(deltaTime);
                lastTimeClicked=newTime;
            }
        }
        if (count<3){
            var newX= checkerX();
            var newY = checkerY();
            oldSize = parseFloat(circle.style.height);
            setNewCircle(newX,newY,oldSize);
            lastY = newY;
            lastX = newX;
            count++;

        } else {
        //TODO:change page!
            //window.location.href="tCEnd.html";
            getId();}
    }

    function setNewCircle(newX,newY,oldSize) {
        circle.style.top = newY+'px';
        circle.style.left = newX+'px';
        randomSize();
        var newSize = parseFloat(circle.style.height);
        wArray.push(newSize);

        if(newX>lastX){
            dXArray.push((newX+newSize/2)-(lastX+oldSize/2));
        }else {
            dXArray.push(((lastX+oldSize/2)-(newX+newSize/2)));
        }

        if(newY>lastY){
            dYArray.push((newY+newSize/2)-(lastY+oldSize/2));
        }else {
            dYArray.push(((lastY+oldSize/2)-(newY+newSize/2)));
        }




    }

    function getDistance() {
        var dis;
        var dArray = new Array;
        for(var i = 0; i<dXArray.length;i++){
           dis = parseInt(Math.sqrt(Math.pow(dXArray[i],2)+Math.pow(dYArray[i],2)));
           dArray.push(dis);
        }
        dArray[dArray.length]=862;

        return dArray;
    }

    function getId() {
        var dArray = getDistance();
        var meanD=0;
        var meanW=0;
        var meanTM=0;
        for (var i = 0;i<dArray.length;i++){
            meanD+=dArray[i];
            meanW+=wArray[i];
        }

        for (var t = 0;t<tArray.length;t++){
            meanTM+=tArray[t];
            alert(tArray[t]);
        }

        //meanW+=wArray[wArray.length-1];
        meanTM/=tArray.length;
        meanW=parseInt(meanW/wArray.length);
        meanD= parseInt(meanD/dArray.length);
        alert("meanD: "+meanD+"  , meanW: "+meanW+"  ,TM:"+meanTM+" ms.");

    }

    function randomSize() {
        var random= Math.floor(Math.random()*(5-1+1)+1);
        switch (random){
            case 1:
                if(v1<2){
                    circle.style.width= 5+'px';
                    circle.style.height=5+'px';
                    v1++;
                }else {
                    randomSize();
                }
                break;
            case 2:
                if(v2<2){
                    circle.style.width= 10+'px';
                    circle.style.height=10+'px';
                    v2++; }else {
                    randomSize();
                }

                break;
            case 3:
                if(v3<2){
                    circle.style.width= 20+'px';
                    circle.style.height=20+'px';
                v3++;
                }else {
                    randomSize();
                }
                break;
            case 4:
                if (v4<2){
                    circle.style.width= 30+'px';
                    circle.style.height=30+'px';
                    v4++;
                }else {
                    randomSize();
                }


                break;
            case 5:
                if (v5<2){
                    circle.style.width= 50+'px';
                    circle.style.height=50+'px';
                    v5++;
                }else {
                    randomSize();
                }

                break;

        }

    }

    function checkerX() {
        var posX= randomNumberX();
        var parseW = parseFloat(circle.style.width);
        oldSize= parseW;
            while ((posX<=lastX+30&&posX>lastX)||(posX>=(lastX-parseW-30)&&posX<lastX)){
                posX= randomNumberX();
            }

            return posX;

    }


    function checkerY() {
        var posY=randomNumberY();
        while ((posY<=lastX+30&&posY>lastY)||(posY>=lastY-130&&posY<lastY)){
            posY= randomNumberY();
        }

        return posY;
    }
    
    function randomNumberX() {
        return Math.floor(Math.random()*(932-10+1)+10);
    }


    function randomNumberY() {
        return Math.floor(Math.random()*(676-10+1)+10);
    }


</script>
</html>